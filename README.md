# LDI-TOF-MS
The presented R workflow has been developed for the analysis of mass spectra of inorganic materials. The main goal is to create a script that will be able to automatically identify overlapping complex isotope distributions in mass spectra. This will primarily be done by estimating possible stoichiometries based on the assumed elemental composition of the material and possible impurities. Generate model distributions of the predicted stoichiometries. Calculate the percentage of each cluster that fits the experimental data and the final fit to these data. 
In addition, the workflow presented includes a number of additional features such as batch processing of mass spectra, pre-processing and alignment of spectra. Functions for calculating Kendrick mass, comparing the number of identified signals from experimental data with individual models, and the ability to detect isobaric interferences in ICP-MS.
# DATA
Data from an LDI-TOF MS analysis of an elemental mixture of gallium and selenium were used as example data to demonstrate the proposed R script. The dataset contains 5 exported mass spectra in text format (.txt) together with metadata. In addition, the exported mass spectra are used in Excel format (.xlsx). The data were acquired on an Axima Resonance quadrupole ion trap mass spectrometer (Kratos Analytical, Manchester, UK).
# DESCRIPTION OF THE UTILIZED LIBRARY
Libraries MALDIquant (Gibb, Strimmer 2012) and MALDIrp-pa are comprehensive packages for pre-processing mass spec-tra. This comprehensive libraries facilitate quality control, implements a variance-stabilising transformation with smooth-ing, and eliminates chemical background through baseline correction. Furthermore, it provides calibration for both inten-sity values (normalisation) and m/z values (alignment). Some pre-processing and diagnostics functions are also available in MassSpecWavelet, MsCoreUtils (Rainer et al. 2022), prospectr and PROcess libraries.

MALDIquant and MALDIrppa libraries also facilitate peak detection, and includes options for post-processing filtering. Peaks identification functions are also involved in the R librar-ies pracma and scorepeak.

There is a significant scarcity of approaches for modeling, selecting, and fitting the isotopic distributions of inorganic clusters. The calculation of cluster stoichiometry can be per-formed using the rcdk library (Guha 2007), as the Rdisop and enviGCMS libraries are primarily designed for use with organ-ic molecules and therefore not suitable for this purpose. 

In order to model isotopic patterns, the R library enviPat (Loos et al. 2015). is the most applicable, as the alternative libraries BRAIN and OrgMassSpecR are only applicable to organic molecules.

The fitting of a linear combination of individual cluster spec-tra to a measured spectrum is achieved through nonlinear regression via the Port algorithm (function nls in the basic statistics library), which is subsequently followed by the cal-culation of a mixed isotopic pattern.

Kendrick mass and Kendrick mass defect are commonly used for identification of homologous compounds differing only by a number of base units in analysis of organic compounds and their mixtures (Hughey et al. 2001; Fouquet 2019; Merel 2023) or organic derivatives (e.g. Shah et al. 2007). However, it can be also employed for analysis inorganic compounds of monoisotopic elements (e.g. Prokeš et al. 2014; Kubáček et al. 2018) or oxidized species (e.g. Allen et al. 1996; Ayers et al. 2014; Huang et al. 2023) in the future. With R software, they can be calculated MsCoreUtils or enviGCMS. Average (atom-ic/molecular) mass calculation is included in the libraries bio-gas, CHNOSZ, marelac, MSbox, PeriodicTable, only for organic molecules also BRAIN and OrgMassSpec libraries are available. For the exact mass calculation related functions are included in enviGCMS and InterpretMSSpectrum libraries, functions calculation of monoisotopic mass are available only for organic molecules in BRAIN, IDSL.UFA (Fakouri Baygi et al. 2022) and OrgMassSpec libraries.

For parsing of molecular formulas and subsequent chemical elements counting CHNOSZ and MetaboCoreUtils libraries.

In addition to LDI-TOF MS, the functions can be easily adapted and used to analyse spectra obtained by other mass spectrom-etry methods, e.g. spectra of organometallic compounds from GC-MS or organic derivatives (e.g. Duffield et al. 1968; Meija et al. 2005; Cody, Fouquet 2019),, or to model isobaric inter-ferences for ICP-MS (e.g. May, Wiedmeyer 1998; Rodríguez-Castrillón 2009).
